<!doctype html>
<html class="docs-version-current" lang="de" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="Rule The Bots" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Mit dem Roboter einen Strichcode dekodieren | Rule The Bots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://spacehal.github.io/docs/robotik/botBarcode"><meta data-react-helmet="true" name="docsearch:language" content="de"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Mit dem Roboter einen Strichcode dekodieren | Rule The Bots"><meta data-react-helmet="true" name="description" content="Mit einem Linienfolger einen Barcode (Strichcode) dekodieren."><meta data-react-helmet="true" property="og:description" content="Mit einem Linienfolger einen Barcode (Strichcode) dekodieren."><meta data-react-helmet="true" name="keywords" content="Roboter,Linienfolger,Barcode,Strichcode,dekodieren,Binärzahlen,Dualzahlen"><link data-react-helmet="true" rel="icon" href="/img/LogoSmallRed.svg"><link data-react-helmet="true" rel="canonical" href="https://spacehal.github.io/docs/robotik/botBarcode"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/botBarcode" hreflang="de"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/botBarcode" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d1942bf1.css">
<link rel="preload" href="/assets/js/runtime~main.1d047c41.js" as="script">
<link rel="preload" href="/assets/js/main.71b590ca.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Zum Hauptinhalt springen</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">RuleTheBots</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/arduino/helloworld">Arduino</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/robotik/beginning">Robotik</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zumo32u4/gettingStarted">Zumo32u4</a><a class="navbar__item navbar__link" href="/docs/more/links">Links</a><div class="searchBox_1Kl_"><button type="button" class="DocSearch DocSearch-Button" aria-label="Suche"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Suche</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"><b>RuleTheBots</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/robotik/beginning">Robotik</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/beginning">Linienfolger</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/docs/robotik/wheelEncoder">Motorencoder</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/wheelEncoder">Motorencoder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/goStraight">Ge­ra­de­aus­fahrt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/speedControl">Geschwindigkeitsregler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/robotik/botBarcode">Anwendung: Barcode</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/odometrie">Navigation und Lokalisierung</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/objektFinden">Hinderniserkennung</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/gridNavigation">Gitter</a></div></li></ul></li></ul></nav><button type="button" title="Seitenleiste einklappen" aria-label="Seitenleiste einklappen" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Mit dem Roboter einen Strichcode dekodieren</h1></header><p><strong>UNDER CONSTRUCTION</strong></p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="barcodes">Barcodes<a class="hash-link" href="#barcodes" title="Direkter Link zur Überschrift">​</a></h2><p>Ein <a href="https://de.wikipedia.org/wiki/Strichcode" target="_blank" rel="noopener noreferrer">Strichcode</a> ist eine Anordnung von verschieden breiten parallelen Strichen und Lücken, in welchen eine <a href="https://de.wikipedia.org/wiki/Dualsystem" target="_blank" rel="noopener noreferrer">Dualzahl</a> codiert ist. Barcodes, wie Strichcodes auch genannt werden, lassen sich nicht nur im Supermarkt auf Etiketten finden, sondern überall dort, wo eine einfach anzubringende und von Maschinen lesbare <em>Schrift</em> benötigt wird (z.B. ISBN-Nummer auf Büchern, Adressen auf Postsendungen, Identifikation von Gepäckstücken, Pharmazeutika, etc.). </p><p>Auch die inzwischen weitverbreiteten <a href="https://de.wikipedia.org/wiki/QR-Code" target="_blank" rel="noopener noreferrer">QR-Codes</a> codieren Informationen mit schwarzen und weißen Feldern. Im Unterschied zum einfachen Strichcode werden hier aber die Informationen zweidimensional mit schwarzen und weißen Quadraten gespeichert. Dadurch erreichen QR-Codes eine deutlichen höheren Informationsgehalt von bis zu 3 kByte (2.956 Byte).</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="dualzahlen">Dualzahlen<a class="hash-link" href="#dualzahlen" title="Direkter Link zur Überschrift">​</a></h2><p>In einem Strichcode werden Daten oft in Dualzahlen gespeichert, da sie nur aus den Ziffern 0 und 1 bestehen. Ähnlich wie bei den Dezimalzahlen hat jede Stelle bei einer Dualzahl eine andere Wertigkeit. Während die <strong>Wertigkeit</strong> der Stellen bei Dezimalzahlen auf der Basis 10 beruht (Einer-, Zehner-, Hunderter-, Tausender-Stelle) beruht die Wertigkeit der Dualstellen auf der Basis 2. Für die kleinste Stelle folgt somit eine Wertigkeit von <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>0</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^0 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span></span></span></span></span>. Die nächst höhere Stelle weist eine Wertigkeit von <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1 = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">2</span></span></span></span></span> auf. Dann folgen die Wertigkeiten <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>2</mn></msup><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">2^2=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">4</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">2^3=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">8</span></span></span></span></span>, usw.</p><img src="/img/robotik/Dualzahlen.png" alt="Umwandlung einer Dualzahl" width="290px" class="center"><p>Soll eine Dualzahl in eine Dezimalzahl <strong>umgewandelt</strong> werden, muss jede Stelle der Dualzahl mit ihrer entsprechenden Wertigkeit multipliziert und anschließend alle Werte aufaddiert werden. In obiger Abbildung ist beispielhaft die Umwandlung der Dualzahl <code>1101</code> in die Dezimalzahl 13 dargestellt.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ein-strichcode-für-den-roboter">Ein Strichcode für den Roboter<a class="hash-link" href="#ein-strichcode-für-den-roboter" title="Direkter Link zur Überschrift">​</a></h2><p>In einem einfachen Strichcode steht eine weiße Linie für eine <code>0</code> und eine schwarze Linie steht für eine <code>1</code>. In dem unten aufgeführten Beispiel bilden 5 Striche eine Dualzahl aus 5 Stellen (man sagt auch 5 Bit Dualzahl). Aus der Strichfolge ergibt sich dabei die Zahl <code>10011</code>. </p><p>Im Prinzip ist jede beliebige Kombination von weißen und schwarzen Strichen möglich, wobei jedoch der erste Strich immer schwarz sein muss. Dieser erste schwarze Strich ist das <strong>Synchronisierungsbit</strong> (Sync-Bit), welches notwendig ist, damit der Roboter erkennen kann, wann der Strichcode beginnt. Dementsprechend speichert ein 5 Bit langer Strichcode nur 4 Bit an Informationen, womit sich Dezimalzahlen von 0 bis 15 darstellen lassen.</p><img src="/img/robotik/BarCodeBot.png" alt="Einfacher Strichcode für einen Roboter" width="470px" class="center"><p>Bei der Umwandlung der sich aus dem Strichcode ergebenden Dualzahl in eine Dezimalzahl ist die Reihenfolge der Bits wichtig. Für den hier verwenden Barcode wird festgelegt, dass das erste Bit nach dem Sync-Bit die höchste Wertigkeit hat. Das Sync-Bit selbst wird bei der Umwandlung in eine Dezimalzahl nicht berücksichtigt.<br>
<!-- -->Für das obige Beispiel ergibt sich ohne Sync-Bit die Bitfolge <code>0011</code>, was der Dezimalzahl <code>3</code> entspricht.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="auslesen-mit-den-bodensensoren">Auslesen mit den Bodensensoren<a class="hash-link" href="#auslesen-mit-den-bodensensoren" title="Direkter Link zur Überschrift">​</a></h2><p>Das Auslesen des Barcodes geschieht durch den Bodensensor des Roboters. Der unten dargestellte Signalverlauf des Bodensensors ergibt sich, wenn der Zumo Roboter über über einen 5 Bit Strichcode mit dem Wert (Bits) <code>10011</code> fährt. Die auf der x- Achse angegebene zurückgelegte Strecke wird dabei mit dem Motorencoder bestimmt und ist später für die Dekodierung wichtig.</p><div class="chartwrappersmall"><canvas role="img" height="50" width="100"></canvas></div><p>Im Diagramm ist neben dem Verlauf des Bodensensors auch die <strong>Erkennung des Schwellwertes</strong> abgebildet. Ist der ermittelte Sensorwert größer als der gegebene Schwellwert (<code>einsLevel = 250</code>), so wird das in dem Verlauf der Schwellwerterkennung optisch dargestellt.</p><p>Ein paar <a target="_blank" href="/assets/files/Test_BarCode_1_5cm-9a77755a27288a49627211a8c1827822.pdf">Strichcodes</a> (5 Bit) zum Ausprobieren können auch heruntergeladen werden.</p><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <ol><li><p><strong>Lesen</strong> Sie mit dem Roboter einen <strong>Strichcode</strong> ein. Schreiben Sie hierzu ein Programm mit folgenden Eigenschaften:</p><ul><li>Der Roboter fährt zuerst nur geradeaus.</li><li>Nachdem das <strong>Sync-Bit</strong> erkannt wurde, soll der Roboter mit dem Motorencoder bis zum Ende des Strichcodes fahren.</li><li>Während er über den Strichcode fährt, gibt der Roboter über die serielle Schnittstelle die Werte des mittleren <strong>Bodensensors</strong> aus.</li><li>Am Ende des Strichcodes bleibt der Roboter stehen.  </li></ul><p>Verwenden Sie folgende Konstanten für Ihr Programm und überlegen Sie sich geeignete Wert:  </p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">#define mmProImpuls 0.128              // Auflösung des Motorencoders in Millimeter pro Impuls</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int barcodeSensor = 2;           // Index des auszuwertenden Sensors</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int anzahlBits    = 5;           // Länge des Barcodes in Bits (inkl. Sync-Bit)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int einsLevel            = /* ??? */;                         // Schwelle zur Erkennung des Sync-Bits</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int symbolBreite         = /* ??? */;                         // Strichbreite in mm</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int symbolBreiteInTicks  = symbolBreite / mmPerTick;          // Strichbreite in Encoder-Impulsen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int barcodeLaengeInTicks = anzahlBits * symbolBreiteInTicks;  // Länge des Barcodes in Motorimpulsen</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li><li><p>Erweitern Sie das Programm aus der letzten Aufgabe um eine <strong>Schwellwerterkennung</strong> der logischen <code>1</code> bzw. der logischen <code>0</code>.  </p><p>Wenn der Sensorwert den Schwellwert <code>einsLevel</code> überschreitet, soll die Variable <code>sensorZustand</code> den Wert <code>1000</code> annehmen, ansonsten soll sie den Wert <code>0</code> annehmen. Wählen Sie für den Schwellwert <code>einsLevel</code> einen geeigneten Wert.</p><p> Geben Sie auf dem seriellen Monitor durch ein Komma getrennt, sowohl den Sensorwert als auch die Variable <code>sensorZustand</code> aus. Mit dem seriellen Plotter kann dann der <strong>Verlauf von beiden Werte</strong> angezeigt werden.</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">// Ausgabe der beiden Werte zur korrekten Darstellung mit dem seriellen Plotter</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">serial.print(sensorWert); Serial.print(&quot;, &quot;); serial.println(schwellwertErkennung);</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li></ol></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="dekodieren-des-strichcodes">Dekodieren des Strichcodes<a class="hash-link" href="#dekodieren-des-strichcodes" title="Direkter Link zur Überschrift">​</a></h2><p>Soll der Barcode mit dem Bodensensor nicht nur ausgelesen, sondern auch in die entsprechenden Bits umgewandelt werden, muss der Strichcode mit dem Bodensensor an <strong>bestimmten Punkten abgetastet</strong> werden. Ist der Sensorwert an den Abtastpunkten größer als der Schwellwert, würde das einer <code>1</code> entsprechen. Die Abtastung findet sinnvollerweise genau einmal pro Strich jeweils in der Mitte statt.</p><p>Ein Programm, welches einen Barcode dekodiert, also die einzelnen Bits des Codes erkennt, muss im wesentlichen Folgendes leisten.</p><ol><li>Der <strong>Sensor</strong> zum Erkennen des Sync-Bits muss anfangs kontinuierlich <strong>ausgelesen</strong> werden.</li><li>Wenn das <strong>Sync-Bit erkannt</strong> wurde (<code>sensorWert &gt; einsLevel</code>), beginnt die Dekodierung.<ol><li>Damit die einzelnen Striche möglichst in der Mitte abgetastet werden, fährt der Roboter noch die Strecke <code>offsetAbtastungInTicks</code> weiter, um dann das Sync-Bit <strong>abzutasten</strong> (1. Bit). Es wird überprüft, ob der Sensorwert größer als der Schwellwert ist. </li><li>Die nächsten Bits werden in einem, der Symbolbreite entsprechedem Intervall (<code>symbolBreiteInTicks</code>), abgetastet.</li></ol></li><li>Die Dekodierung wird am Ende des Barcodes, zum Beispiel nach 5 Bits, beendet.</li></ol><p>Die Abtastpunkte sind in der Abbildung noch einmal graphisch dargestellt.</p><img src="/img/robotik/BarCodeSignal.png" alt="Barcode detektieren" width="580px" class="center"><p>Für eine bessere Übersichtlichkeit sollten am Anfang des Programms die wichtigsten Größen des Strichcodes angegeben werden:</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">#define mmProImpuls 0.128              // Auflösung des Motorencoders in Millimeter pro Impuls</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int barcodeSensor = 2;           // Index des auszuwertenden Sensors</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int anzahlBits    = 5;           // Länge des Barcodes in Bits (inkl. Sync-Bit)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int einsLevel              = /* ??? */;                         // Schwelle zur Erkennung des Sync-Bits</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int symbolBreite           = /* ??? */;                         // Strichbreite in mm</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int symbolBreiteInTicks    = symbolBreite / mmPerTick;          // Strichbreite in Encoder-Impulsen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int barcodeLaengeInTicks   = anzahlBits * symbolBreiteInTicks;  // Länge des Barcodes in Motorimpulsen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const int offsetAbtastungInTicks = /* ??? */;                         // Verschiebung des Abtastpunkt in Encoder-Impulsen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">bool datenBarcode[5] = {0,0,0,0,0};    // Array für dekodierte Barcode Bits</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Im Hauptprogramm fährt dann der Roboter solange geradeaus, bis das Sync-Bit erkannt wurde. Anschließend wird die Funktion <code>abtastenBarcode()</code> aufgerufen.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">/* Hauptstruktur des Strichcode-Dekodierers*/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">void loop()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">{</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  lineSensors.readCalibrated(linienSensorWerte);   // Sensorwerte lesen des Zumo 32u4 lesen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  int sensorWert = linienSensorWerte[indexSensor];</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Auf das Sync-Bit warten</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  if ( sensorWert &gt; einsLevel) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    abtastenBarcode();                             // Der Barcode wird abgetastet und in  Bits umgewandelt</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    motors.setSpeeds(0, 0);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    buttonA.waitForButton();</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Die <code>abtastenBarcode()</code> Funktion übernimmt dann die eigentliche Arbeit.  Möglichst in der Mitte der Barcode-Striche werden diese abgetastet und das Ergebnis des Abtastens (<code>0</code> oder <code>1</code>) in den globalen Array <code>datenBarcode[]</code> geschrieben.</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">// Abtasten des Barcodes. Erkennung des Sync-Bits wird separat durchgeführt</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">void abtastenBarcode(){</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  int bitIndex        = 0;           // Index des aktuellen Bits des Barcodes</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  int abtastpunkt     = 0;           // Zum Debuggen. Wird am Abtastpunkten `1000`, ansonsten `0`</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  ledRed(1); ledGreen(0);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  int encoderTicks    = 0;           </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  encoders.getCountsAndResetLeft();  // Motorencoder zurücksetzen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  encoders.getCountsAndResetRight(); // Motorencoder zurücksetzen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Über die Länge des Barcodes die einzelnen Bits abtasten.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  while (encoderTicks &lt; barcodeLaengeInTicks)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    /***** Fehlenden  Code ergänzen *****</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     *  - Impulse der Motor-Encoder bestimmen (Mittelwert der beiden Motoren)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     *  - Werte des Liniensensors  aktualisieren</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     *  - Jedes Bit des Barcodes genau einmal in der Mitte abtasten</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     *  - Wert des abgetasteten Strichs an der richtigen Stelle im Array `datenBarcode` speichern</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     ************************************/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  ledRed(0); ledGreen(1);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="barcode-in-dezimalzahl-umwandeln">Barcode in Dezimalzahl umwandeln<a class="hash-link" href="#barcode-in-dezimalzahl-umwandeln" title="Direkter Link zur Überschrift">​</a></h2><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <p>Schreiben Sie ein Funktion <code>int binToDez()</code>, welche eine vom Roboter ausgelesene Bitfolgen in Dezimalzahlen umwandelt. Das erste Bit, also das Bit mit dem Index <code>[0]</code> ist das Sync-Bit. Die Funktion soll zuerst überprüfen, ob das Sync-Bit <code>1</code> ist und dann die andern Bits in eine Dezimalzahl umwandeln und als Ergebnis zurückgeben. Ist das Sync-Bit nicht <code>1</code>, wird <code>-1</code> zurückgegeben.</p><p>Testen Sie Ihre Funktion mit den angegeben Beispielen.</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">bool code1[5] = {1,0,0,0,1}; // dezimal 1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">bool code2[5] = {1,1,0,0,0}; // dezimal 8</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">bool code3[4] = {1,1,0,0};   // dezimal 4</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">bool code4[4] = {1,1,1,0};   // dezimal 6</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">bool code5[4] = {0,1,1,0};   // dezimal 6, aber kein Sync-Bit</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">int codeToDec(bool pCode[], int pAnzahlBits){</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  /*</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">   * Code für die Umwandlung</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="nicht-blockierender-dekoder-mulitasking">Nicht-blockierender Dekoder (Mulitasking)<a class="hash-link" href="#nicht-blockierender-dekoder-mulitasking" title="Direkter Link zur Überschrift">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="links">Links<a class="hash-link" href="#links" title="Direkter Link zur Überschrift">​</a></h2><ul><li><a href="https://barcode.tec-it.com/de" target="_blank" rel="noopener noreferrer">Barcodegenrator</a></li><li><a href="https://www.logical-concepts.de/blog/barcode-typen/" target="_blank" rel="noopener noreferrer">Barcodetypen</a></li><li><a href="http://aseba.wikidot.com/de:thymioreadsbarcodes" target="_blank" rel="noopener noreferrer">Thymio liest Barcodes</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Letztes Update<!-- --> am <b><time datetime="2022-01-02T10:28:53.000Z">2.1.2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten Navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/robotik/speedControl"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">Geschwindigkeitsregler</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/robotik/odometrie"><div class="pagination-nav__sublabel">Weiter</div><div class="pagination-nav__label">Odometrie</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#barcodes" class="table-of-contents__link toc-highlight">Barcodes</a></li><li><a href="#dualzahlen" class="table-of-contents__link toc-highlight">Dualzahlen</a></li><li><a href="#ein-strichcode-für-den-roboter" class="table-of-contents__link toc-highlight">Ein Strichcode für den Roboter</a></li><li><a href="#auslesen-mit-den-bodensensoren" class="table-of-contents__link toc-highlight">Auslesen mit den Bodensensoren</a></li><li><a href="#dekodieren-des-strichcodes" class="table-of-contents__link toc-highlight">Dekodieren des Strichcodes</a></li><li><a href="#barcode-in-dezimalzahl-umwandeln" class="table-of-contents__link toc-highlight">Barcode in Dezimalzahl umwandeln</a></li><li><a href="#nicht-blockierender-dekoder-mulitasking" class="table-of-contents__link toc-highlight">Nicht-blockierender Dekoder (Mulitasking)</a></li><li><a href="#links" class="table-of-contents__link toc-highlight">Links</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/SpaceHal/spacehal.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Schule</div><ul class="footer__items"><li class="footer__item"><a href="https://www.osztiem.de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>OSZTIEM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.arduino.cc/reference/de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Arduino<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/impressum">Impressum</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Stefan Warm. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1d047c41.js"></script>
<script src="/assets/js/main.71b590ca.js"></script>
</body>
</html>